<!DOCTYPE html><html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æˆèªæ–¹å¡ŠéŠæˆ²</title>
<script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>
<style>
*{box-sizing:border-box}
body{margin:0;font-family:"Noto Sans TC",sans-serif;background:#f0f4f8;height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;-webkit-user-select:none;user-select:none;overflow:hidden}
#scoreBoard{margin-top:.5rem;font-size:1.2rem;font-weight:700}
#gameBoard {
  position: relative;
  width: 100%;
  max-width: 480px;
  height: 80vh;
  max-height: 700px;
  background-image: url('village_background.png');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-color: rgba(255,255,255,0.5);
  background-blend-mode: lighten;
  border: 3px solid #444;
  border-radius: 8px;
  overflow: hidden;
  display: none;
}
.block{position:absolute;width:56px;height:56px;background:#8bc34a;border:2px solid #558b2f;border-radius:4px;color:#fff;font-size:1.5rem;font-weight:700;display:flex;align-items:center;justify-content:center;touch-action:none}
.stacked{background:#4caf50}
#slotContainer{position:absolute;bottom:8px;left:50%;transform:translateX(-50%);display:flex;gap:6px}
.slot{width:56px;height:56px;background:#e0e0e0;border:2px dashed #9e9e9e;border-radius:4px;display:flex;align-items:center;justify-content:center}
.slot.correct{border-color:#4caf50}
.slot.incorrect{border-color:#f44336}
.overlay{position:absolute;inset:0;background:rgba(0,0,0,.75);color:#fff;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:1rem;z-index:10}
.overlay h1{font-size:2rem;margin-bottom:1rem}
.overlay p{line-height:1.6;margin:0 auto 1.5rem;max-width:350px}
.overlay button{margin:.4rem;padding:.6rem 1.4rem;border:none;border-radius:4px;background:#ffeb3b;font-size:1rem;font-weight:700;cursor:pointer}
</style>
</head>
<body>
<div id="scoreBoard" style="display:none"> åˆ†æ•¸ï¼š0 / 20</div>
<div id="introOverlay" class="overlay">
<h1>æˆèªæ–¹å¡ŠéŠæˆ²</h1>
<p>éŠæˆ²è¦å‰‡ï¼šæ‹–æ›¸æ‰è½çš„å­—å¡Šï¼Œ<br>æ”¾å…¥åº•éƒ¨ 4 å€‹æ–¹æ ¼ï¼Œ<br>æ‹¼å‡ºæ­£ç¢ºæˆèªå³å¯å¾—åˆ†ã€‚<br>æ¯ 10 ç§’æœƒæ‰è½æ–°ä¸€çµ„å­—å¡Šï¼Œ<br>ç©å®¶éœ€è¦è‡ªè¡Œèª¿æ•´å­—å¡Šä½ç½®ï¼Œ<br>é¿å…å­—å¡Šå †ç–Šåˆ°é ‚ï¼Œ<br>å¦å‰‡éŠæˆ²å°‡æœƒè‡ªå‹•çµæŸã€‚</p>
<button id="startBtn">é–‹å§‹éŠæˆ²</button>
</div>
<div id="gameBoard">
<div id="slotContainer">
<div class="slot" data-index="0"></div>
<div class="slot" data-index="1"></div>
<div class="slot" data-index="2"></div>
<div class="slot" data-index="3"></div>
</div>
<div id="messageOverlay" class="overlay" style="visibility:hidden"></div>
</div>
<script>
const idioms=["ä¸€ç«…ä¸é€š","ä¸æ¥ä¸‹å•","èŒ…å¡é “é–‹","ç™¼äººæ·±çœ","ä»Šéæ˜”æ¯”","è€ç”Ÿå¸¸è«‡","æ‹‹ç£šå¼•ç‰","æ‹¾äººç‰™æ…§","èªç„¡å€«æ¬¡","å¼·è©å¥ªç†","ä¸€ç‰‡å†°å¿ƒ","å¤§ç¾©å‡œç„¶","å‡ºçˆ¾åçˆ¾","å®ˆæ­£ä¸é˜¿","å¤é“ç†±è…¸","åæ‡·ä¸äº‚","é“ä¸æ‹¾éº","è¦‹ç¾©å‹‡ç‚º","æ¶“æ»´æ­¸å…¬","é£²æ°´æ€æº"];
const distractorPool="å¤©åœ°ç„é»ƒå®‡å®™æ´ªè’æ—¥æœˆç›ˆæ˜ƒè¾°å®¿åˆ—å¼µå¯’ä¾†æš‘å¾€ç§‹æ”¶å†¬è—é–é¤˜æˆæ­²å¾‹å‘‚èª¿é™½é›²é¨°è‡´é›¨éœ²çµç‚ºéœœé¢¨é›¨é›·é›»å±±å·è‰æœ¨é³¥ç¸èŸ²é­šæ±Ÿæ²³æ¹–æµ·æ˜Ÿè¾°å…‰é™°æ­²æœˆèŠ±è‰æ¨¹æœ¨".split("");
const board=document.getElementById('gameBoard');
const slots=[...document.querySelectorAll('.slot')];
const overlay=document.getElementById('messageOverlay');
const scoreBoard=document.getElementById('scoreBoard');
const slotContainer=document.getElementById('slotContainer');
const intro=document.getElementById('introOverlay');
const startBtn=document.getElementById('startBtn');
let score=0,usedIdioms=new Set(),fallIntervals=[],spawnInterval;
const rand=(min,max)=>Math.floor(Math.random()*(max-min+1))+min;
const shuffle=a=>{for(let i=a.length-1;i>0;i--){const j=rand(0,i);[a[i],a[j]]=[a[j],a[i]];}return a;};
const updateScore=()=>scoreBoard.textContent=`åˆ†æ•¸ï¼š${score} / 20`;
const bottomLimit=()=>board.offsetHeight-slotContainer.offsetHeight-8;
const fallSpeed=()=>board.offsetHeight/320;
startBtn.onclick=()=>{intro.style.display='none';board.style.display='block';scoreBoard.style.display='block';startGame();};
function startGame(){spawnBlocks();spawnInterval=setInterval(spawnBlocks,10000);}
function spawnBlocks(){if(overlay.style.visibility==='visible')return;if(usedIdioms.size===idioms.length)usedIdioms.clear();let idm;do{idm=idioms[rand(0,idioms.length-1)];}while(usedIdioms.has(idm));usedIdioms.add(idm);const chars=idm.split("");const dis=[];while(dis.length<2){const c=distractorPool[rand(0,distractorPool.length-1)];if(!chars.includes(c)&&!dis.includes(c))dis.push(c);}shuffle([...chars,...dis]).forEach((c,i)=>setTimeout(()=>createBlock(c),i*300));}
function createBlock(ch){const b=document.createElement('div');b.className='block';b.textContent=ch;b.dataset.char=ch;b.style.left=`${rand(0,board.clientWidth-56)}px`;b.style.top='-60px';board.appendChild(b);makeDraggable(b);startFalling(b);}
function startFalling(bl){const id=setInterval(()=>{if(bl.isDragging)return;const nxt=bl.offsetTop+fallSpeed();if(nxt+56>=bottomLimit()||[...board.querySelectorAll('.block.stacked')].some(b=>collide(bl,b,2))){settle(bl,id);}else bl.style.top=`${nxt}px`;},16);bl.fallID=id;fallIntervals.push(id);}    
function settle(bl,id){clearInterval(id);fallIntervals=fallIntervals.filter(x=>x!==id);bl.classList.add('stacked');bl.fallID=null;checkGameOver();}
function collide(a,b,o=0){if(a===b)return false;const r1=a.getBoundingClientRect(),r2=b.getBoundingClientRect();return r1.left<r2.right&&r1.right>r2.left&&r1.bottom+o>r2.top&&r1.top<r2.bottom;}
function makeDraggable(el){interact(el).draggable({listeners:{start(){el.isDragging=true;if(el.parentElement.classList.contains('slot')){const slt=el.parentElement;slt.dataset.char='';slt.classList.remove('correct','incorrect');board.appendChild(el);const br=board.getBoundingClientRect(),sr=slt.getBoundingClientRect();el.style.left=`${sr.left-br.left}px`;el.style.top=`${sr.top-br.top}px`;el.style.position='absolute';el.setAttribute('data-x',0);el.setAttribute('data-y',0);if(el.fallID==null)startFalling(el);} },move(e){let x=(+el.getAttribute('data-x')||0)+e.dx;let y=(+el.getAttribute('data-y')||0)+e.dy;const maxX=board.clientWidth-el.offsetWidth,maxY=board.clientHeight-el.offsetHeight;x=Math.min(Math.max(x+el.offsetLeft,0),maxX)-el.offsetLeft;y=Math.min(Math.max(y+el.offsetTop,0),maxY)-el.offsetTop;el.style.transform=`translate(${x}px,${y}px)`;el.setAttribute('data-x',x);el.setAttribute('data-y',y);},end(){el.isDragging=false;}},inertia:true,modifiers:[interact.modifiers.restrictRect({restriction: board,endOnly:true})]});}
interact('.slot').dropzone({accept:'.block',overlap:0.4,ondropactivate(e){e.target.classList.remove('correct','incorrect');},ondrop(e){const slt=e.target,blk=e.relatedTarget;if(slt.firstElementChild)return;if(blk.fallID){clearInterval(blk.fallID);fallIntervals=fallIntervals.filter(x=>x!==blk.fallID);blk.fallID=null;}blk.style.transform='none';blk.setAttribute('data-x',0);blk.setAttribute('data-y',0);blk.style.position='static';slt.appendChild(blk);slt.dataset.char=blk.dataset.char;checkSlots();}});
function checkSlots(){const str=slots.map(s=>s.dataset.char||'').join('');if(str.length!==4)return;if(idioms.includes(str)){slots.forEach(s=>s.classList.add('correct'));setTimeout(()=>{slots.forEach(s=>{if(s.firstElementChild)s.firstElementChild.remove();s.dataset.char='';s.classList.remove('correct');});score++;updateScore();if(score>=20)endGame('ğŸ† æ­å–œä½ å–å¾—æ»¿åˆ†ï¼');},600);}else{slots.forEach(s=>s.classList.add('incorrect'));}}
function checkGameOver(){const topY=board.getBoundingClientRect().top;if([...board.querySelectorAll('.block.stacked')].some(b=>b.getBoundingClientRect().top<=topY+10))endGame('Game OverğŸ˜­');}
function clearAll(){fallIntervals.forEach(id=>clearInterval(id));fallIntervals=[];clearInterval(spawnInterval);}
function endGame(msg){clearAll();overlay.innerHTML=`${msg}<br/>`;const r=document.createElement('button');r.textContent='é‡æ–°é–‹å§‹';r.onclick=()=>location.reload();const e=document.createElement('button');e.textContent='çµæŸéŠæˆ²';e.onclick=()=>{overlay.innerHTML='è¬è¬åƒèˆ‡ğŸ˜€';};overlay.appendChild(r);overlay.appendChild(e);overlay.style.visibility='visible';}
window.addEventListener('resize', ()=>{
  [...document.querySelectorAll('.block')].forEach(block => {
    if (!block.isDragging) {
      block.style.top = `${Math.min(parseInt(block.style.top)||0, bottomLimit()-56)}px`;
    }
  });
});
</script>
</body>
</html>
